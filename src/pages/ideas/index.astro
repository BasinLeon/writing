---
import Layout from '../../layouts/Layout.astro';
import { getCollection } from 'astro:content';

const ideas = (await getCollection('ideas'))
  .sort((a, b) => b.data.lastEdited.valueOf() - a.data.lastEdited.valueOf());

const excerpt = (text: string, count = 20) => {
  const words = text.trim().split(/\s+/).filter(Boolean);
  return words.slice(0, count).join(' ') + (words.length > count ? '...' : '');
};
---

<Layout title="Literary Ideas | Leon Basin Literary" description="Living digital garden of seeds, incubating notes, and mature concepts.">
  <section class="latest">
    <p class="kicker">Digital Garden</p>
    <h1>Literary Ideas</h1>
    <ol class="writing-list">
      {ideas.map((idea) => (
        <li>
          <p class="writing-title">{idea.data.title}</p>
          <p class="writing-meta">
            {idea.data.lastEdited.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })}
            {' â€¢ '}
            {idea.data.status}
          </p>
          <p class="lede">{excerpt(idea.body)}</p>
        </li>
      ))}
    </ol>
  </section>
</Layout>
